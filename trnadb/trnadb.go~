package trnadb

import "keltainen.duckdns.org/rnafolding/base"

func ReadSequence(r io.Reader, name string) (*base.Sequence,error) {
	br:= bufio.NewReader(r)
	for {
		c, err := br.ReadString('\n')
		if err != nil && err != io.EOF {
			return nil, err
		}
		if strings.BeginsWith(c, name+" ") {
			comment, bases := parseLine(c)
			return &base.Sequence{
				Comment: comment,
				Bases: bases,
			}
		}
		if err == io.EOF {
			break
		}
	}
				return nil, errors.New("trnadb.ReadSequence: sequence \"%s\" not found in database", name)
}
